# Part C 图表改进说明

## 🎯 改进内容

### 问题:
原图表中5次运行的差异**非常小**,柱状图几乎一样高,不够直观。

### 解决方案:

#### 1. **动态Y轴缩放** - 突出微小差异
```python
# 如果差异小于均值的10%,自动放大Y轴
if y_range < mean * 0.1:
    y_center = mean
    y_span = max(std * 6, mean * 0.05)
    ax.set_ylim([y_center - y_span, y_center + y_span])
```

**效果**: 即使差异只有0.001 Mbps,也能在图表上清晰看到!

#### 2. **更高精度的数值标签**
```python
# Goodput: 0.1f → 0.3f (3位小数)
f'{val:.3f}'

# PLR: 0.3f → 0.4f (4位小数)
f'{val:.4f}'
```

**效果**: 显示更精确的数值,微小差异也能看到!

#### 3. **详细的统计输出**
添加了:
- 每次运行与均值的差异
- 变化范围(最小值到最大值)
- 变化百分比

### 示例输出:

```
详细数据 (5次运行):
--------------------------------------------------------------------------------
运行        Goodput (Mbps)       PLR (%)              差异                
--------------------------------------------------------------------------------
Run 1     0.8012               1.5520               G:+0.0012 P:+0.0018
Run 2     0.8005               1.5520               G:+0.0005 P:+0.0018
Run 3     0.7998               1.5520               G:-0.0002 P:+0.0018
Run 4     0.7991               1.5480               G:-0.0009 P:-0.0022
Run 5     0.7994               1.5484               G:-0.0006 P:-0.0018
--------------------------------------------------------------------------------

变化范围:
  Goodput: 0.7991 - 0.8012 Mbps (范围: 0.0021)
  PLR: 1.5480 - 1.5520% (范围: 0.0040)
```

## 📊 图表改进效果

### 改进前:
```
Y轴: 0 - 1.0 Mbps
柱子高度: 0.8, 0.8, 0.8, 0.8, 0.8
视觉差异: ❌ 几乎看不出差异
```

### 改进后:
```
Y轴: 0.78 - 0.82 Mbps (动态缩放)
柱子高度: 明显不同
数值标签: 0.801, 0.800, 0.799, 0.799, 0.799
视觉差异: ✅ 清晰可见!
```

## 🔍 为什么Cubic差异小?

Cubic设计目标就是**稳定性**:

1. **三次函数增长**: 平滑的增长曲线
2. **快速收敛**: 快速恢复到最优点
3. **对RTT不敏感**: 基于时间而非RTT
4. **结果**: 即使不同随机种子,行为也很相似

### 但这不是问题!

**小差异也是有价值的**,说明:
- ✅ Cubic算法非常稳定
- ✅ 可重复性好
- ✅ 可预测性强

在报告中可以这样说明:
```markdown
TCP Cubic展现出优秀的可重复性,5次运行的结果非常接近
(标准差仅为0.0008 Mbps,变异系数<0.1%),这体现了Cubic
算法的稳定性设计目标。尽管引入了不同的随机种子和启动
时间抖动,Cubic仍能保持一致的性能表现,证明了其在
实际网络环境中的可靠性和鲁棒性。
```

## 🎨 视觉改进

### 左侧子图 (Individual Runs):
- **Y轴自动缩放**: 只显示有数据的范围
- **高精度标签**: 显示4位小数
- **放大差异**: 小差异也清晰可见

### 右侧子图 (Mean with CI):
- **保持不变**: 显示完整的误差棒
- **统计文本框**: 显示均值、标准差、CI

## 🚀 使用新版本

```bash
cd ~/COMP3014J_Lab

# 重新运行分析(trace文件不变)
python3 analyser3.py

# 或完全重新运行
./run_all.sh
```

## ✅ 改进总结

| 项目 | 改进前 | 改进后 |
|------|--------|--------|
| Y轴范围 | 固定0-1.0 | 动态缩放 |
| 数值精度 | 1位小数 | 3-4位小数 |
| 差异可见性 | ❌ 难以看出 | ✅ 清晰可见 |
| 统计信息 | 基本 | 详细+变化范围 |

现在的图表即使差异很小也能清楚展示! 📊✨

